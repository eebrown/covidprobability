<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probability of Undetected COVID-19 on a Unit • covidprobability</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Probability of Undetected COVID-19 on a Unit">
<meta property="og:description" content="covidprobability">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">covidprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/unit-example.html">Probability of Undetected COVID-19 on a Unit</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/eebrown/covidprobability/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="unit-example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Probability of Undetected COVID-19 on a Unit</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eebrown/covidprobability/blob/master/vignettes/unit-example.Rmd"><code>vignettes/unit-example.Rmd</code></a></small>
      <div class="hidden name"><code>unit-example.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eebrown/covidprobability">covidprobability</a></span><span class="op">)</span></code></pre></div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>When a person later found to have COVID-19 may have exposed people living on a unit (such as a floor of a hospital or long term care home), infection prevention and control (IPAC) measures are implemented to reduce the risk of transmission among infected people on that unit. This is done to prevent morbidity and mortality from COVID-19, but the risk of COVID-19 is also balanced by the harms of the IPAC measures themselves, such as the loneliness and physical deconditioning that can result from preventing visitors and restricting residents to their rooms. The probability that an undetected case of COVID-19 is present on a unit following possible exposures is therefore a key figure in determining when lift certain IPAC measures.</p>
<p>Here, we propose a method to estimate the probability of an undetected case of COVID-19, when a given number of people have been exposed, with a given pretest probability of having COVID-19 as a result of that exposure. Since we are interested in undetected COVID-19, we assume no person has developed symptoms (which would warrant further investigation) and that everyone was tested with polymerase chain reaction (PCR) on a given day, and all tested negative.</p>
<div id="presence-of-covid-19-on-the-unit" class="section level3">
<h3 class="hasAnchor">
<a href="#presence-of-covid-19-on-the-unit" class="anchor"></a>Presence of COVID-19 on the unit</h3>
<p>To identify the congregate setting following a suspected exposure event, several assumptions and determinations must be made</p>
<ol style="list-style-type: decimal">
<li>Estimate the pretest probability for each exposure</li>
<li>Assume the exposure events are independent</li>
<li>Determine the date of the exposure (or last possible date) to set as <code>Day 0</code>.</li>
</ol>
<p>Empirical data are required:</p>
<ol style="list-style-type: decimal">
<li>What is the sensitivity and specificity of the test available, by day since exposure?</li>
<li>What is the distribution of the incubation period (for symptomatic cases) in the target population?</li>
<li>What proportion of cases are asymptomatic in the target population?</li>
</ol>
</div>
</div>
<div id="methods" class="section level2">
<h2 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h2>
<div id="pretest-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#pretest-probability" class="anchor"></a>pretest probability</h3>
<p>The initial pretest probability (at Day 0) of each exposed resident following exposure or possible exposure is specified by the investigator. The initial pretest probability is the expected probability the individual will develop COVID-19.</p>
<p>Here, we are not considering the scenario where a resident’s pretest probability increases due to the presence of symptoms. The goal of this tool is to aid the decision of when to test and when to ease restrictions if all exposed remain asymptomatic and no cases are detected.</p>
<p>The incubation period of COVID-19 has been modeled by several groups and a meta-analysis pooled 8 studies to estimate a lognormal distribution of the incubation period <span class="citation">[@mcaloonIncubation2020]</span> with mu 1.63 (1.51, 1.75), sigma 0.5 (0.45-0.55).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">dlnorm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fl">1.63</span>, <span class="fl">0.5</span><span class="op">)</span>, 
     xlab<span class="op">=</span><span class="st">"Days after exposure"</span>, 
     ylab<span class="op">=</span><span class="st">"Probability"</span>, 
     main<span class="op">=</span><span class="st">"Incubation period"</span>,
     type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>First ignoring asymptomatic individuals, we can calculate the daily pretest probability for those who do not develop symptoms.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">plnorm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fl">1.63</span>, <span class="fl">0.5</span><span class="op">)</span>,
     ylab<span class="op">=</span><span class="st">"Proportion"</span>, 
     xlab <span class="op">=</span> <span class="st">"Days since exposure"</span>,
     main<span class="op">=</span><span class="st">"Infected expected to have developed symptoms"</span>,
     type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>The proportion of cases that are asymptomatic will vary depending on patient population. Further, the empirical data may be limited by undetected cases in ecological studies. With respect to nursing home residents, a meta-analysis found that 27.9% remained asymptomatic through follow up (Yanes-Lane et al. 2020).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="va">prop_remaining</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>, mu <span class="op">=</span> <span class="fl">1.63</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
     ylab<span class="op">=</span><span class="st">"Proportion remaining"</span>, xlab <span class="op">=</span> <span class="st">"Day"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>With each passing day, if no one develops symptoms, even without testing, the pretest probability is lowered in proportion to the number of people who would have been expected to develop symptoms by that time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.13</span>, <span class="fu"><a href="../reference/adjust_pretest.html">adjust_pretest</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asymp <span class="op">=</span> <span class="fl">0.279</span>, days <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span>, 
     ylab<span class="op">=</span><span class="st">"pretest probability"</span>, xlab<span class="op">=</span><span class="st">"Day"</span>, type <span class="op">=</span> <span class="st">"b"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div id="sensitivity" class="section level3">
<h3 class="hasAnchor">
<a href="#sensitivity" class="anchor"></a>Sensitivity</h3>
<p>To account for the changing sensitivity of the PCR COVID-19 test, we used the PCR sensitivity values from a model derived from empirical data in a meta-analysis (Kucirka et al. 2020), as reported at [<a href="https://github.com/HopkinsIDD/covidRTPCR" class="uri">https://github.com/HopkinsIDD/covidRTPCR</a>].</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">point</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
     main<span class="op">=</span><span class="st">"PCR Sensitivity with 95% CI"</span>,
     xlab<span class="op">=</span><span class="st">"Days since exposure"</span>, ylab<span class="op">=</span><span class="st">"Sensitivity"</span>,
     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>; 
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">lower</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">upper</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
</div>
<div id="posttest-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#posttest-probability" class="anchor"></a>Posttest Probability</h3>
<p>Posttest probability can be calculated from the estimated pretest probability and the sensitivity and specificity of the test. Here, we assume a 100% specificity, and use the day-by-day sensitivity plotted above to calculate the posttest probability if testing occurred on each day, to determine the optimal day to test.</p>
<p>Below, we demonstrate the posttest probabilities on an example person with a 13% pretest probability at exposure and assuming 27.9% of patients in this setting remain asymptomatic.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posttest_series.html">posttest_series</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>,
                           sens <span class="op">=</span> <span class="va">sens</span><span class="op">$</span><span class="va">point</span>, spec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">example_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posttest_series.html">posttest_series</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>, sens <span class="op">=</span> <span class="va">sens</span><span class="op">$</span><span class="va">upper</span>, 
                                 spec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">example_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posttest_series.html">posttest_series</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>, sens <span class="op">=</span> <span class="va">sens</span><span class="op">$</span><span class="va">lower</span>,
                                 spec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">x</span>, <span class="va">example</span><span class="op">$</span><span class="va">y</span>, 
     xlab<span class="op">=</span><span class="st">"Day of testing"</span>, 
     ylab<span class="op">=</span><span class="st">"Probability of having COVID-19"</span>,
     main<span class="op">=</span><span class="st">"Red = pretest; Blue = posttest"</span>,
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">x</span>, <span class="va">example</span><span class="op">$</span><span class="va">y</span>, 
      col<span class="op">=</span><span class="st">"blue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_lower</span><span class="op">$</span><span class="va">x</span>, <span class="va">example_lower</span><span class="op">$</span><span class="va">y</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_upper</span><span class="op">$</span><span class="va">x</span>, <span class="va">example_upper</span><span class="op">$</span><span class="va">y</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="fu"><a href="../reference/adjust_pretest.html">adjust_pretest</a></span><span class="op">(</span><span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span><span class="op">)</span>, 
      col<span class="op">=</span><span class="st">"red"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
</div>
<div id="unit-wide-posttest-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#unit-wide-posttest-probability" class="anchor"></a>Unit-wide posttest Probability</h3>
<p>The relevant risk in deciding whether to maintain heightened precautions on a unit is the probability that any person is infected, or alternatively, the complement of the probability that no person is infected. That is, the probability of any case being present, is 1 less the additive probability of each case not being present.</p>
<p>Below, we determine the posttest probability of any person having undetected COVID-19 by day, if all people were tested on the same day. Note again that the x-axis reflects the date of testing.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">unit_size</span> <span class="op">&lt;-</span> <span class="fl">4</span>

<span class="va">any_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_any.html">probability_any</a></span><span class="op">(</span><span class="va">unit_size</span>, <span class="va">example</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="va">any_example_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_any.html">probability_any</a></span><span class="op">(</span><span class="va">unit_size</span>, <span class="va">example_upper</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="va">any_example_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_any.html">probability_any</a></span><span class="op">(</span><span class="va">unit_size</span>, <span class="va">example_lower</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">x</span>, <span class="va">any_example</span>, 
     xlab<span class="op">=</span><span class="st">"Day of testing"</span>, 
     ylab<span class="op">=</span><span class="st">"Probability of any person having COVID-19"</span>,
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.50</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_lower</span><span class="op">$</span><span class="va">x</span>, <span class="va">any_example_lower</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_upper</span><span class="op">$</span><span class="va">x</span>, <span class="va">any_example_upper</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">example</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">example</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>In the above example, testing on day 9 yields the lowest overall posttest probability; it is the minimum. If we specify the date of testing, we can calculate and plot the change in estimated probability over time, with dates prior to testing reflecting pretest probability on that day and dates after testing reflecting posttest probability, again assuming no one develops symptoms.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/individual_probability.html">individual_probability</a></span><span class="op">(</span>test_day <span class="op">=</span> <span class="fl">9</span>, pre0 <span class="op">=</span> <span class="fl">0.13</span>, sens <span class="op">=</span> <span class="va">sens</span>, spec <span class="op">=</span> <span class="fl">1</span>, 
                               asymp <span class="op">=</span> <span class="fl">0.279</span>, days <span class="op">=</span> <span class="fl">14</span>, mu <span class="op">=</span> <span class="fl">1.63</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="va">test</span><span class="op">$</span><span class="va">point</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"Individual probabiltiy of undetected COVID-19"</span>,
     xlab <span class="op">=</span> <span class="st">"Days since exposure"</span>,
     ylab <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">lower</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">upper</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>Now, using the above example, we assume there were 10 exposures and calculate the unit-wide probability of an undetected COVID-19 infection over time, again assuming all were tested on day 9.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">test_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unit_probability.html">unit_probability</a></span><span class="op">(</span>test_day <span class="op">=</span> <span class="fl">9</span>, pre0 <span class="op">=</span>  <span class="fl">0.13</span>, sens <span class="op">=</span> <span class="va">sens</span>, spec <span class="op">=</span> <span class="fl">1</span>, 
                           asympt <span class="op">=</span> <span class="fl">0.279</span>, days <span class="op">=</span> <span class="fl">14</span>, mu <span class="op">=</span> <span class="fl">1.63</span>, sigma <span class="op">=</span> <span class="fl">0.5</span>, 
                           n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="va">test_n</span><span class="op">$</span><span class="va">point</span>, type<span class="op">=</span><span class="st">"b"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"Unit-wide probabiltiy of undetected COVID-19"</span>,
     xlab <span class="op">=</span> <span class="st">"Days since exposures"</span>,
     ylab <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">lower</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">upper</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">point</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">point</span>, <span class="fl">2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>In this example, testing on day 9 reveals a unit-wide posttest probability of 10% on day 9 and 9% when testing on day 9 and waiting until day 14. Using the lower 95% confidence interval for test sensitivity, a conservative approach, and testing on day 9, the unit-wide estimate is 14% on day 9 and 13% on day 14.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_n</span><span class="op">$</span><span class="va">point</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.09605053</span>
<span class="va">test_n</span><span class="op">$</span><span class="va">point</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.08898011</span>

<span class="va">test_n</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.1410912</span>
<span class="va">test_n</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.1309287</span></code></pre></div>
</div>
</div>
<div id="discussion" class="section level2">
<h2 class="hasAnchor">
<a href="#discussion" class="anchor"></a>Discussion</h2>
<div id="limitations-and-assumptions" class="section level3">
<h3 class="hasAnchor">
<a href="#limitations-and-assumptions" class="anchor"></a>Limitations and Assumptions</h3>
<p>The results produced by this package are based on estimates and have several assumptions which may mean that it is not suitable for a given setting. This package should not be relied upon for clinical decisions, but may be useful to explore the possible relationship between certain parameters and the probability of undetected COVID-19 in a setting, acknowledging the assumptions made.</p>
<div id="parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#parameters" class="anchor"></a>Parameters</h4>
<p>The parameters of the model are themselves also estimates. The estimates depend on empirical data which were generally compiled from different settings. The underlying data may not apply to the setting to which the calculator is applied. This may be particularly true, for example, as emerging variants of COVID-19 impact the parameters needed for the calculations.</p>
<p>The distribution for the incubation period is pooled from various sources and only the point estimate of the distribution is used here. McAloon et al. report a lognormal distribution (mu = 1.63, sigma = 0.5). Lauer et al. report a similar distribution (mu = 1.621, sigma = 0.418).</p>
<p>The varying sensitivity of PCR tests is a pooled Bayesian estimate (Kucirka et al. 2020), and various assumptions were made to determine this best estimate, as described by the authors. Even if accurate, the test characteristics at a given site would be different than a pooled average.</p>
<p>The user-specified parameters are inherently estimates as well.</p>
<p>Pretest probability could be approximated by looking at average attack rates in certain settings with certain types of encounters. The nature of the encounter and timing of the case’s infection are important factors (<a href="https://www.publichealthontario.ca/-/media/documents/ncov/main/2020/09/covid-19-contact-tracing-risk-assessment.pdf?la=en" class="uri">https://www.publichealthontario.ca/-/media/documents/ncov/main/2020/09/covid-19-contact-tracing-risk-assessment.pdf?la=en</a>).</p>
<p>The rate of true asymptomatic infections appears to vary by setting and have considerable heterogeneity. For example, at 27.9% (13.0 - 49.8%) in nursing home residents and 58.8% (48.8 - 68.1%) in obstetrical patients presenting to hospitals (Yanes-Lane et al. 2020).</p>
</div>
<div id="model-assumptions" class="section level4">
<h4 class="hasAnchor">
<a href="#model-assumptions" class="anchor"></a>Model assumptions</h4>
<p>The model herein assumes that no exposed individuals have developed symptoms (and assumes that those who do have been identified). However, the model can be agnostic to symptoms if the proportion of asymptomatic individuals is set to 1.</p>
<p>The model assumes that exposures were independent events.</p>
</div>
</div>
<div id="future-directions-and-contributing" class="section level3">
<h3 class="hasAnchor">
<a href="#future-directions-and-contributing" class="anchor"></a>Future Directions (and Contributing)</h3>
<p>This R package and accompanying Shiny app are available to the public for review. Any corrections or improvements can be recommended by filing a Github issue. As further research is done into COVID-19, improved estimates of the parameters may become available and can be incorporated into this tool.</p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Kucirka LM, Lauer SA, Laeyendecker O, Boon D, Lessler J. Variation in False-Negative Rate of Reverse Transcriptase Polymerase Chain Reaction–Based SARS-CoV-2 Tests by Time Since Exposure. Annals of Internal Medicine. 2020;173(4):262-267. <a href="http://dx.doi.org/10.7326/M20-1495" class="uri">http://dx.doi.org/10.7326/M20-1495</a></p>
<p>A. Lauer S, H. Grantz K, Bi Q, et al. The Incubation Period of Coronavirus Disease 2019 (COVID-19) From Publicly Reported Confirmed Cases: Estimation and Application. Annals of Internal Medicine. Published online March 10, 2020. <a href="http://dx.doi.org/10.7326/M20-0504" class="uri">http://dx.doi.org/10.7326/M20-0504</a></p>
<p>McAloon C, Collins Á, Hunt K, et al. Incubation period of COVID-19: a rapid systematic review and meta-analysis of observational research. BMJ Open. 2020;10(8):e039652. <a href="http://dx.doi.org/10.1136/bmjopen-2020-039652" class="uri">http://dx.doi.org/10.1136/bmjopen-2020-039652</a></p>
<p>Yanes-Lane M, Winters N, Fregonese F, et al. Proportion of asymptomatic infection among COVID-19 positive persons and their transmission potential: A systematic review and meta-analysis. PLOS ONE. 2020;15(11):e0241536. <a href="http://dx.doi.org/10.1371/journal.pone.0241536" class="uri">http://dx.doi.org/10.1371/journal.pone.0241536</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eric Brown.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
