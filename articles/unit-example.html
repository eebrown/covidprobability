<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probability of Undetected COVID-19 on a Unit • covidprobability</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Probability of Undetected COVID-19 on a Unit">
<meta property="og:description" content="covidprobability">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">covidprobability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/unit-example.html">Probability of Undetected COVID-19 on a Unit</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="unit-example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Probability of Undetected COVID-19 on a Unit</h1>
            
      
      
      <div class="hidden name"><code>unit-example.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">covidprobability</span><span class="op">)</span></code></pre></div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<div id="pre-test-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#pre-test-probability" class="anchor"></a>Pre-test probability</h3>
<p>The pre-test probability of a COVID-19 infection can be inferred from what is known about SARS-CoV-2 transmission, from the nature of a given exposure, and from empirical data about attack rates in different settings and ages. If someone who is exposed does not develop symptoms, the pre-test probability will drop over time, based on the incubation period of COVID-19. That is, if someone has not developed symptoms by 14 days, the probability of having COVID-19 is very low, in line with World Health Organization guidelines for contacts of cases to quarantine for 14 days.<span class="citation">[@worldhealthorganizationConsiderations2020]</span></p>
<p>A complicating factor is that a certain proportion of COVID-19 cases are always asymptomatic, that is they don’t develop symptoms despite infection and may be contagious. Thus when incubation period is defined as the time from exposure to symptom onset, this group is not captured. The lack of emergence of symptoms in this group does not inform pre-test probability in a similarly predictable way.</p>
<p>The pre-test probability can therefore be determined by reducing the probability by the proportion of patients who would be expected to have had symptoms by a given time but did not.</p>
</div>
<div id="testing-for-covid-19" class="section level3">
<h3 class="hasAnchor">
<a href="#testing-for-covid-19" class="anchor"></a>Testing for COVID-19</h3>
<p>Polymerase chain reaction (PCR) is the gold standard diagnostic test for COVID-19 and the most widely available at this time. While the specificity of the test is excellent, approaching 100%, it is less sensitive than it is specific. Thus, a negative test does not rule out the presence of COVID-19 with certainty. Further, the sensitivity of PCR varies by time from exposure, which reflects the changing viral load <span class="citation">[@kucirkaVariation2020]</span>.</p>
</div>
<div id="presence-of-covid-19-on-the-unit" class="section level3">
<h3 class="hasAnchor">
<a href="#presence-of-covid-19-on-the-unit" class="anchor"></a>Presence of COVID-19 on the unit</h3>
<p>To identify the congregate setting following a suspected exposure event, several assumptions and determinations must be made</p>
<ol style="list-style-type: decimal">
<li>Estimate the pre-test probability for each exposure</li>
<li>Assume the exposure events are independent</li>
<li>Determine the date of the exposure (or last possible date) to set as <code>Day 0</code>.</li>
</ol>
<p>Empirical data are required:</p>
<ol style="list-style-type: decimal">
<li>What is the sensitivity and specificity of the test available, by day since exposure?</li>
<li>What is the distribution of the incubation period (for symptomatic cases) in the target population?</li>
<li>What proportion of cases are asymptomatic in the target population?</li>
</ol>
</div>
</div>
<div id="methods" class="section level2">
<h2 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h2>
<div id="pre-test-probability-1" class="section level3">
<h3 class="hasAnchor">
<a href="#pre-test-probability-1" class="anchor"></a>Pre-test probability</h3>
<p>The initial pre-test probability (at Day 0) of each exposed resident following exposure or possible exposure is specified by the investigator. The initial pre-test probability is the expected probability the individual will develop COVID-19.</p>
<p>Here, we are not considering the scenario where a resident’s pre-test probability increases due to the presence of symptoms. The goal of this tool is to aid the decision of when to test and when to ease restrictions if all exposed remain asymptomatic and no cases are detected.</p>
<p>The incubation period of COVID-19 has been modeled by several groups and a meta-analysis pooled 8 studies to estimate a lognormal distribution of the incubation period <span class="citation">[@mcaloonIncubation2020]</span> with mu 1.63 (1.51, 1.75), sigma 0.5 (0.45-0.55).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">dlnorm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fl">1.63</span>, <span class="fl">0.5</span><span class="op">)</span>, 
     xlab<span class="op">=</span><span class="st">"Days after exposure"</span>, 
     ylab<span class="op">=</span><span class="st">"Probability"</span>, 
     main<span class="op">=</span><span class="st">"Incubation period"</span>,
     type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>First ignoring asymptomatic individuals, we can calculate the daily pre-test probability for those who do not develop symptoms.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">plnorm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span>, <span class="fl">1.63</span>, <span class="fl">0.5</span><span class="op">)</span>,
     ylab<span class="op">=</span><span class="st">"Proportion"</span>, 
     xlab <span class="op">=</span> <span class="st">"Days since exposure"</span>,
     main<span class="op">=</span><span class="st">"Infected expected to have developed symptoms"</span>,
     type<span class="op">=</span><span class="st">"b"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>The proportion of cases that are asymptomatic will vary depending on patient population. Further, the empirical data may be limited by undetected cases in ecological studies. With respect to nursing home residents, a meta-analysis found that 27.9% remained asymptomatic through follow up <span class="citation">[@yanes-laneProportion2020]</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="va">prop_remaining</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>, mu <span class="op">=</span> <span class="fl">1.63</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
     ylab<span class="op">=</span><span class="st">"Proportion remaining"</span>, xlab <span class="op">=</span> <span class="st">"Day"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>With each passing day, if no one develops symptoms, even without testing, the pretest probability is lowered in proportion to the number of people who would have been expected to develop symptoms by that time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="fu"><a href="../reference/adjust_pretest.html">adjust_pretest</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asymp <span class="op">=</span> <span class="fl">0.279</span>, days <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">14</span><span class="op">)</span>, 
     ylab<span class="op">=</span><span class="st">"Pre-test probability"</span>, xlab<span class="op">=</span><span class="st">"Day"</span>, type <span class="op">=</span> <span class="st">"b"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div id="sensitivity" class="section level3">
<h3 class="hasAnchor">
<a href="#sensitivity" class="anchor"></a>Sensitivity</h3>
<p>To account for the changing sensitivity of the PCR COVID-19 test, we used the PCR sensitivity values from a model derived from empirical data in a meta-analysis <span class="citation">[@kucirkaVariation2020]</span>, as reported at [<a href="https://github.com/HopkinsIDD/covidRTPCR" class="uri">https://github.com/HopkinsIDD/covidRTPCR</a>].</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">point</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
     main<span class="op">=</span><span class="st">"PCR Sensitivity with 95% CI"</span>,
     xlab<span class="op">=</span><span class="st">"Days since exposure"</span>, ylab<span class="op">=</span><span class="st">"Sensitivity"</span>,
     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>; 
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">lower</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">upper</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
</div>
<div id="post-test-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#post-test-probability" class="anchor"></a>Post-test Probability</h3>
<p>Post-test probability can be calculated from the estimated pre-test probability and the sensitivity and specificity of the test. Here, we assume a 100% specificity, and use the day-by-day sensitivity plotted above to calculate the post-test probability if testing occurred on each day, to determine the optimal day to test.</p>
<p>Below, we demonstrate the post-test probabilities on an example person with a 13% pretest probability at exposure and assuming 27.9% of patients in this setting remain asymptomatic.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posttest_series.html">posttest_series</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>,
                           sens <span class="op">=</span> <span class="va">sens</span><span class="op">$</span><span class="va">point</span>, spec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">example_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posttest_series.html">posttest_series</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>, sens <span class="op">=</span> <span class="va">sens</span><span class="op">$</span><span class="va">upper</span>, 
                                 spec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">example_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posttest_series.html">posttest_series</a></span><span class="op">(</span>pre0 <span class="op">=</span> <span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span>, sens <span class="op">=</span> <span class="va">sens</span><span class="op">$</span><span class="va">lower</span>,
                                 spec <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">x</span>, <span class="va">example</span><span class="op">$</span><span class="va">y</span>, 
     xlab<span class="op">=</span><span class="st">"Day of testing"</span>, 
     ylab<span class="op">=</span><span class="st">"Probability of having COVID-19"</span>,
     main<span class="op">=</span><span class="st">"Red = pre-test; Blue = post-test"</span>,
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">x</span>, <span class="va">example</span><span class="op">$</span><span class="va">y</span>, 
      col<span class="op">=</span><span class="st">"blue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_lower</span><span class="op">$</span><span class="va">x</span>, <span class="va">example_lower</span><span class="op">$</span><span class="va">y</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_upper</span><span class="op">$</span><span class="va">x</span>, <span class="va">example_upper</span><span class="op">$</span><span class="va">y</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, <span class="fu"><a href="../reference/adjust_pretest.html">adjust_pretest</a></span><span class="op">(</span><span class="fl">0.13</span>, asympt <span class="op">=</span> <span class="fl">0.279</span><span class="op">)</span>, 
      col<span class="op">=</span><span class="st">"red"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
</div>
<div id="unit-wide-post-test-probability" class="section level3">
<h3 class="hasAnchor">
<a href="#unit-wide-post-test-probability" class="anchor"></a>Unit-wide post-test Probability</h3>
<p>The relevant risk in deciding whether to maintain heightened precautions on a unit is the probability that any person is infected, or alternatively, the complement of the probability that no person is infected. That is, the probability of any case being present, is 1 less the additive probability of each case not being present.</p>
<p>Below, we determine the post-test probability of any person having undetected COVID-19 by day, if all people were tested on the same day. Note again that the x-axis reflects the date of testing.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">unit_size</span> <span class="op">&lt;-</span> <span class="fl">4</span>

<span class="va">any_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_any.html">probability_any</a></span><span class="op">(</span><span class="va">unit_size</span>, <span class="va">example</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="va">any_example_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_any.html">probability_any</a></span><span class="op">(</span><span class="va">unit_size</span>, <span class="va">example_upper</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="va">any_example_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_any.html">probability_any</a></span><span class="op">(</span><span class="va">unit_size</span>, <span class="va">example_lower</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">x</span>, <span class="va">any_example</span>, 
     xlab<span class="op">=</span><span class="st">"Day of testing"</span>, 
     ylab<span class="op">=</span><span class="st">"Probability of any person having COVID-19"</span>,
     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.50</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_lower</span><span class="op">$</span><span class="va">x</span>, <span class="va">any_example_lower</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">example_upper</span><span class="op">$</span><span class="va">x</span>, <span class="va">any_example_upper</span>, 
      col<span class="op">=</span><span class="st">"lightblue"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">example</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">example</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">example</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>In the above example, testing on day 9 yields the lowest overall post-test probability; it is the minimum. If we specify the date of testing, we can calculate and plot the change in estimated probability over time, with dates prior to testing reflecting pre-test probability on that day and dates after testing reflecting post-test probability, again assuming no one develops symptoms.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/individual_probability.html">individual_probability</a></span><span class="op">(</span>test_day <span class="op">=</span> <span class="fl">9</span>, pre0 <span class="op">=</span> <span class="fl">0.13</span>, sens <span class="op">=</span> <span class="va">sens</span>, spec <span class="op">=</span> <span class="fl">1</span>, 
                               asymp <span class="op">=</span> <span class="fl">0.279</span>, days <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, mu <span class="op">=</span> <span class="fl">1.63</span>, sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="va">test</span><span class="op">$</span><span class="va">point</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"Individual probabiltiy of undetected COVID-19"</span>,
     xlab <span class="op">=</span> <span class="st">"Days since exposure"</span>,
     ylab <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">lower</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">upper</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>Now, using the above example, we assume there were 10 exposures and calculate the unit-wide probability of an undetected COVID-19 infection over time, again assuming all were tested on day 9.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">test_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unit_probability.html">unit_probability</a></span><span class="op">(</span>test_day <span class="op">=</span> <span class="fl">9</span>, pre0 <span class="op">=</span>  <span class="fl">0.13</span>, sens <span class="op">=</span> <span class="va">sens</span>, spec <span class="op">=</span> <span class="fl">1</span>, 
                           asympt <span class="op">=</span> <span class="fl">0.279</span>, days <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">14</span>, mu <span class="op">=</span> <span class="fl">1.63</span>, sigma <span class="op">=</span> <span class="fl">0.5</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="va">test_n</span><span class="op">$</span><span class="va">point</span>, type<span class="op">=</span><span class="st">"b"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
     main <span class="op">=</span> <span class="st">"Unit-wide probabiltiy of undetected COVID-19"</span>,
     xlab <span class="op">=</span> <span class="st">"Days since exposures"</span>,
     ylab <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">lower</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">upper</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">14</span>, <span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">point</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">test_n</span><span class="op">$</span><span class="va">point</span>, <span class="fl">2</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="unit-example_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>In this example, testing on day 9 reveals a unit-wide post-test probability of 11% on day 9 and 10% when testing on day 9 and waiting until day 14. Using the lower 95% confidence interval for test sensitivity, a conservative approach, and testing on day 9, the unit-wide estimate is 16% on day 9 and 14% on day 14.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_n</span><span class="op">$</span><span class="va">point</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.106424</span>
<span class="va">test_n</span><span class="op">$</span><span class="va">point</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.09516177</span>

<span class="va">test_n</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.1558517</span>
<span class="va">test_n</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span>
<span class="co">#&gt; [1] 0.1397402</span></code></pre></div>
</div>
</div>
<div id="discussion" class="section level2">
<h2 class="hasAnchor">
<a href="#discussion" class="anchor"></a>Discussion</h2>
<div id="limitations-and-assumptions" class="section level3">
<h3 class="hasAnchor">
<a href="#limitations-and-assumptions" class="anchor"></a>Limitations and Assumptions</h3>
</div>
<div id="future-directions-and-contributing" class="section level3">
<h3 class="hasAnchor">
<a href="#future-directions-and-contributing" class="anchor"></a>Future Directions (and Contributing)</h3>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eric Brown.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
